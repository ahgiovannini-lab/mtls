@startuml
left to right direction
skinparam componentStyle rectangle

title Anti-patterns e armadilhas comuns (mTLS outbound)

rectangle "Anti-patterns" {
  component "Desabilitar validação SSL para 'funcionar rápido'" as A1
  component "Configurar truststore mas desabilitar hostname verification" as A2
  component "Usar pinning sem processo de rotação" as A3
  component "Colocar .p12 dentro da imagem Docker" as A4
  component "Confundir Jetty inbound com client-side TLS" as A5
}

rectangle "Consequências" {
  component "Risco: exposição a MITM" as C1
  component "Risco: conexão com host errado" as C2
  component "Risco: outage na rotação" as C3
  component "Risco: secrets vazam no build" as C4
  component "Risco: troubleshooting errado" as C5
}

A1 --> C1
A2 --> C2
A3 --> C3
A4 --> C4
A5 --> C5

note right of A1
  mTLS acontece no handshake TLS
  (antes do HTTP)
end note

note right of A4
  Keystore = quem eu sou
  Truststore = no que eu confio
end note
@enduml
